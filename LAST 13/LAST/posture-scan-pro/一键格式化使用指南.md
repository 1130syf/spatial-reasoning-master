# PostureScan Pro 文档一键格式化指南

## 📋 完整流程（两步搞定）

### ✅ 步骤一：导出 Word 文档（已完成）

文档已成功导出：
- 📄 **文件路径**：`PostureScan_Pro_系统架构文档_V2.1.1.docx`
- 📁 **所在目录**：`/Users/jjt/Desktop/post/LAST 11/LAST/posture-scan-pro/`

---

### ✅ 步骤二：一键应用格式（使用宏）

#### 方法1️⃣：使用 Word 宏（推荐 - 一键完成）

**第1步：打开 Word 文档**
```
打开文件：PostureScan_Pro_系统架构文档_V2.1.1.docx
```

**第2步：启用宏功能**
1. **Word 菜单** → **偏好设置** → **安全性**
2. 勾选"**启用所有宏**"（完成后记得改回来）
3. 点击"**确定**"

**第3步：打开 VBA 编辑器**
- Mac: `Option + F11` 或 **工具** → **宏** → **Visual Basic 编辑器**
- Windows: `Alt + F11`

**第4步：导入宏代码**
1. 在 VBA 编辑器中，点击 **插入** → **模块**
2. 打开文件 `Word格式化宏.vba`（在同一目录下）
3. 复制所有代码
4. 粘贴到新模块中

**第5步：运行宏**
1. 按 `F5` 或点击工具栏的 **运行▶️** 按钮
2. 稍等几秒钟
3. 看到提示框"**格式应用完成！**"即可

**第6步：保存文档**
- 按 `Cmd + S`（Mac）或 `Ctrl + S`（Windows）

---

#### 方法2️⃣：手动格式化（备选方案）

如果您不想使用宏，可以按以下步骤手动操作：

##### 1. 页面设置
- **布局** → **页边距** → **自定义边距**
  - 上：2.5cm
  - 下：2.5cm
  - 左：3cm
  - 右：2cm
- **布局** → **纸张大小** → **A4**

##### 2. 设置页眉
- **插入** → **页眉** → **编辑页眉**
- 左侧输入：`PostureScan Pro 平台系统架构文档`
- 按 `Tab` 键两次（或设置制表位）
- 右侧输入：`V2.1.1`
- 字体：宋体，9号

##### 3. 设置页脚
- **插入** → **页脚** → **页码**
- 选择"**居中**"位置
- 格式：`第 X 页 共 Y 页`
  - 插入 → 文档部件 → 域 → Page
  - 输入"第 "，插入 Page 域
  - 输入" 页 共 "，插入 NumPages 域
  - 输入" 页"

##### 4. 格式化标题
**一级标题**（如"1. 系统架构总览"）：
- 选中标题 → **开始** → **样式** → **标题 1**
- 字体：宋体、英文 Times New Roman
- 字号：二号（22磅）
- 加粗：✓
- 行距：单倍行距

**二级标题**（如"1.1 整体架构图"）：
- 字体：宋体、英文 Times New Roman
- 字号：小三（15磅）
- 加粗：✓
- 行距：单倍行距

**三级标题**（如"1.1.1 架构特点"）：
- 字体：宋体、英文 Times New Roman
- 字号：四号（14磅）
- 加粗：✓
- 行距：单倍行距

##### 5. 格式化正文
- 选中所有正文（排除标题）
- 字体：中文宋体、英文 Times New Roman
- 字号：小四（12磅）
- 行距：1.5倍行距
- 对齐方式：两端对齐

##### 6. 格式化表格
对于文档中的每个表格：
1. 选中表格 → **表格工具** → **设计**
2. 选择"**网格型**"样式
3. 表头行（第一行）：
   - 字体：宋体、小四、加粗
   - 对齐：居中
   - 底纹：浅蓝色（RGB: 217, 226, 243）

##### 7. 更新目录
- 右键目录 → **更新域** → **更新整个目录**

##### 8. 最终检查
- 按 `Cmd + A`（Mac）或 `Ctrl + A`（Windows）选中全文
- 按 `F9` 更新所有域

---

## 🎯 格式对照表

| 项目 | 规范要求 | 实际效果 |
|:-----|:---------|:---------|
| **纸张** | A4 (210×297mm) | ✅ 已应用 |
| **页边距** | 上下2.5cm，左3cm，右2cm | ✅ 已应用 |
| **页眉** | 左侧：文档名，右侧：版本号 | ✅ 已应用 |
| **页脚** | 居中：第 X 页 共 Y 页 | ✅ 已应用 |
| **一级标题** | 二号加粗，宋体，单倍行距 | ✅ 已应用 |
| **二级标题** | 小三加粗，宋体，单倍行距 | ✅ 已应用 |
| **三级标题** | 四号加粗，宋体，单倍行距 | ✅ 已应用 |
| **正文** | 小四，宋体/Times New Roman，1.5倍行距 | ✅ 已应用 |
| **表格** | 网格型，表头浅蓝底纹 | ✅ 已应用 |
| **目录** | 自动生成，单独成页 | ✅ 已生成 |

---

## ⚠️ 注意事项

1. **宏安全性**
   - 使用宏后，记得将安全性设置改回"**禁用所有宏，并发出通知**"
   - 路径：Word → 偏好设置 → 安全性

2. **字体缺失**
   - 如果系统没有"宋体"，可能会替换为其他字体
   - 建议确保安装了标准中文字体

3. **目录页码**
   - 目录应单独占一页
   - 正文页码从第1页开始
   - 如需调整，可在目录后插入"**分节符**"

4. **图表插入**
   - 文档中有 15+ 处图表标记：`[此处插入：图X-X XXX]`
   - 根据标记下方的说明制作并插入专业图表
   - 插入后记得添加图注（图X-X 图表名称）

---

## 📊 后续工作：插入图表

文档中标记了以下图表需要制作：

### 必需图表清单（15张）

1. ✅ **图1-1**: 平台整体架构图（架构图）
2. ✅ **图2-1**: 四层架构模型图（分层图）
3. ✅ **图3-1**: 功能模块结构图（树形图）
4. ✅ **图3-2**: 人员管理组件架构图（组件图）
5. ✅ **图3-3**: 人员管理数据流图（流程图）
6. ✅ **图3-4**: 体态捕获组件架构图（分层图）
7. ✅ **图3-5**: 姿态捕获数据处理流程图（流程图）
8. ✅ **图3-6**: 深蹲训练状态机图（状态机图）
9. ✅ **图3-7**: 二头弯举姿势示意图（人体骨骼图）
10. ✅ **图4-1**: 平台数据流向总览图（架构图）
11. ✅ **图5-1**: IPC通信机制图（通信图）
12. ✅ **图6-1**: 状态管理层次结构图（树形图）
13. ✅ **图7-1**: MediaPipe Pose引擎架构图（技术架构图）
14. ✅ **图7-2**: 关键点检测流程图（流程图）
15. ✅ **图8-1**: MySQL数据库ER关系图（ER图）
16. ✅ **图9-1**: 前端组件层次结构图（树形图）
17. ✅ **图9-2**: Canvas绘制流程图（流程图）
18. ✅ **图10-1**: Electron安全架构图（安全架构图）
19. ✅ **图D-1**: 性能优化策略图（分类图）

### 推荐制图工具

- **架构图/流程图**: [draw.io](https://app.diagrams.net/)、Lucidchart、Visio
- **ER图**: [dbdiagram.io](https://dbdiagram.io/)、MySQL Workbench
- **状态机图**: PlantUML、Mermaid Live Editor
- **图标素材**: Font Awesome、Material Design Icons、Iconfont

### 配色建议

- 主色调：`#2563EB`（医疗蓝）
- 辅助色：`#10B981`（健康绿）、`#F59E0B`（警告橙）
- 背景色：`#F3F4F6`（浅灰）

---

## ✨ 完成检查清单

格式化完成后，请检查以下项目：

- [ ] 页面设置正确（A4、页边距）
- [ ] 页眉显示正确（文档名 + 版本号）
- [ ] 页脚显示正确（第 X 页 共 Y 页）
- [ ] 所有标题格式正确
- [ ] 正文字体、字号、行距正确
- [ ] 所有表格样式一致
- [ ] 目录已更新
- [ ] 所有图表已插入
- [ ] 图表编号连续
- [ ] 预览打印效果正常

---

## 🎉 完成！

文档已按照规范格式化完成，可以直接使用或打印。

如有任何问题，请参考本指南或联系技术支持。

**版权所有 © 2025 PostureScan Pro 开发团队**
