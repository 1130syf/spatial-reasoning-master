# PostureScan Pro æ•°æ®åº“å»ºç«‹æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨ä¸º PostureScan Pro å»ºç«‹å®Œæ•´çš„ MySQL æ•°æ®åº“ã€‚æ•°æ®åº“åŒ…å«æ‚£è€…ç®¡ç†ã€å§¿æ€è¯„ä¼°ã€è¿åŠ¨è®­ç»ƒç­‰æ ¸å¿ƒåŠŸèƒ½æ¨¡å—çš„æ•°æ®å­˜å‚¨ã€‚

## ğŸ¯ æ•°æ®åº“æ¶æ„

PostureScan Pro ä½¿ç”¨ MySQL 8.0+ æ•°æ®åº“ï¼ŒåŒ…å«ä»¥ä¸‹6ä¸ªæ ¸å¿ƒè¡¨ï¼š

1. **patients** - æ‚£è€…ä¿¡æ¯è¡¨
2. **assessments** - å§¿æ€è¯„ä¼°è®°å½•è¡¨
3. **exercise_categories** - è¿åŠ¨åˆ†ç±»è¡¨
4. **exercises** - è¿åŠ¨é¡¹ç›®è¡¨
5. **exercise_reports** - è¿åŠ¨è®­ç»ƒæŠ¥å‘Šè¡¨
6. **exercise_rep_details** - è¿åŠ¨è®­ç»ƒé‡å¤è¯¦ç»†æ•°æ®è¡¨

## ğŸ› ï¸ å»ºç«‹æ•°æ®åº“çš„æ­¥éª¤

### æ­¥éª¤1: å®‰è£… MySQL

å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®‰è£… MySQLï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

#### Windows ç”¨æˆ·ï¼š
1. ä¸‹è½½ MySQL Installer: https://dev.mysql.com/downloads/installer/
2. é€‰æ‹© "mysql-installer-community" ä¸‹è½½
3. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹© "Server only" æˆ– "Developer Default"
4. è®¾ç½® root ç”¨æˆ·å¯†ç ï¼ˆè®°ä½è¿™ä¸ªå¯†ç ï¼‰
5. ç¡®ä¿ MySQL æœåŠ¡æ­£åœ¨è¿è¡Œ

#### macOS ç”¨æˆ·ï¼š
```bash
# ä½¿ç”¨ Homebrew å®‰è£…
brew install mysql

# å¯åŠ¨ MySQL æœåŠ¡
brew services start mysql

# è®¾ç½® root å¯†ç 
mysql_secure_installation
```

#### Linux ç”¨æˆ·ï¼š
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install mysql-server
sudo mysql_secure_installation

# CentOS/RHEL
sudo yum install mysql-server
sudo systemctl start mysqld
sudo mysql_secure_installation
```

### æ­¥éª¤2: åˆ›å»ºæ•°æ®åº“

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ›å»ºæ•°æ®åº“ï¼š

#### æ–¹æ³•A: ä½¿ç”¨å‘½ä»¤è¡Œï¼ˆæ¨èï¼‰

1. æ‰“å¼€å‘½ä»¤è¡Œ/ç»ˆç«¯
2. ç™»å½• MySQLï¼š
```bash
mysql -u root -p
```

3. è¾“å…¥æ‚¨è®¾ç½®çš„ root å¯†ç 

4. æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š
```sql
source "c:\Users\æ—§åŸä»¥è¥¿\Desktop\MyFile\LAST\LAST 13\LAST\posture-scan-pro\database_setup_complete.sql";
```

#### æ–¹æ³•B: ä½¿ç”¨å›¾å½¢ç•Œé¢å·¥å…·

1. ä¸‹è½½å¹¶å®‰è£… MySQL Workbench: https://dev.mysql.com/downloads/workbench/
2. è¿æ¥åˆ°æ‚¨çš„ MySQL æœåŠ¡å™¨
3. æ‰“å¼€ SQL ç¼–è¾‘å™¨
4. å¤åˆ¶ `database_setup_complete.sql` æ–‡ä»¶çš„å†…å®¹
5. æ‰§è¡Œ SQL è„šæœ¬

### æ­¥éª¤3: é…ç½®åº”ç”¨è¿æ¥

æ›´æ–° `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®ï¼š

```env
# æ•°æ®åº“è¿æ¥é…ç½®
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=æ‚¨çš„MySQLå¯†ç 
DB_DATABASE=posture_scan_pro_db
```

**é‡è¦**: å°† `DB_PASSWORD` è®¾ç½®ä¸ºæ‚¨å®é™…çš„ MySQL root å¯†ç ã€‚

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„è¯¦è§£

### 1. patients è¡¨ - æ‚£è€…ä¿¡æ¯
```sql
CREATE TABLE patients (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,           -- æ‚£è€…å§“å
  gender ENUM('ç”·','å¥³','å…¶ä»–'),        -- æ€§åˆ«
  age INT,                              -- å¹´é¾„
  height DECIMAL(5,2),                  -- èº«é«˜(cm)
  weight DECIMAL(5,2),                  -- ä½“é‡(kg)
  lastCapture DATE,                     -- æœ€åæ•è·æ—¥æœŸ
  created_at TIMESTAMP,                 -- åˆ›å»ºæ—¶é—´
  updated_at TIMESTAMP                  -- æ›´æ–°æ—¶é—´
);
```

### 2. assessments è¡¨ - å§¿æ€è¯„ä¼°è®°å½•
```sql
CREATE TABLE assessments (
  id INT PRIMARY KEY AUTO_INCREMENT,
  patient_id INT NOT NULL,              -- æ‚£è€…ID (å¤–é”®)
  assessment_data JSON,                 -- å§¿æ€æ•°æ® (JSONæ ¼å¼)
  screenshot LONGTEXT,                  -- è¯„ä¼°æˆªå›¾
  created_at TIMESTAMP                  -- è¯„ä¼°æ—¶é—´
);
```

### 3. exercise_reports è¡¨ - è¿åŠ¨è®­ç»ƒæŠ¥å‘Š
```sql
CREATE TABLE exercise_reports (
  id INT PRIMARY KEY AUTO_INCREMENT,
  patient_id INT NOT NULL,              -- æ‚£è€…ID (å¤–é”®)
  exercise_type ENUM('æ·±è¹²','äºŒå¤´å¼¯ä¸¾','å…¶ä»–'), -- è¿åŠ¨ç±»å‹
  session_start_time TIMESTAMP,         -- è®­ç»ƒå¼€å§‹æ—¶é—´
  session_end_time TIMESTAMP,           -- è®­ç»ƒç»“æŸæ—¶é—´
  total_attempts INT DEFAULT 0,         -- æ€»å°è¯•æ¬¡æ•°
  valid_reps INT DEFAULT 0,             -- æœ‰æ•ˆæ¬¡æ•°
  success_rate DECIMAL(5,2) DEFAULT 0.00, -- æˆåŠŸç‡(%)
  average_score DECIMAL(5,2) DEFAULT 0.00, -- å¹³å‡å¾—åˆ†
  rep_details JSON,                     -- é‡å¤è¯¦ç»†æ•°æ®
  summary_data JSON,                    -- è®­ç»ƒæ€»ç»“æ•°æ®
  screenshots JSON,                     -- å…³é”®æˆªå›¾
  recommendations TEXT,                  -- æ”¹å–„å»ºè®®
  created_at TIMESTAMP                  -- åˆ›å»ºæ—¶é—´
);
```

## ğŸ”§ éªŒè¯æ•°æ®åº“å®‰è£…

### æ£€æŸ¥æ•°æ®åº“æ˜¯å¦åˆ›å»ºæˆåŠŸï¼š

```sql
-- è¿æ¥åˆ°æ•°æ®åº“
USE posture_scan_pro_db;

-- æŸ¥çœ‹æ‰€æœ‰è¡¨
SHOW TABLES;

-- æŸ¥çœ‹æ‚£è€…æ•°æ®
SELECT * FROM patients;

-- æŸ¥çœ‹è¯„ä¼°æ•°æ®
SELECT * FROM assessments;

-- æŸ¥çœ‹è¿åŠ¨æŠ¥å‘Šæ•°æ®
SELECT * FROM exercise_reports;
```

### æµ‹è¯•åº”ç”¨è¿æ¥ï¼š

1. é‡å¯åç«¯æœåŠ¡å™¨ï¼š
```bash
cd "c:\Users\æ—§åŸä»¥è¥¿\Desktop\MyFile\LAST\LAST 13\LAST\posture-scan-pro"
npm run server
```

2. è®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼š
```
http://localhost:3001/api/health
```

å¦‚æœçœ‹åˆ° `"database": "connected"`ï¼Œè¯´æ˜æ•°æ®åº“è¿æ¥æˆåŠŸï¼

## ğŸ“ åˆå§‹æ•°æ®è¯´æ˜

æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬åŒ…å«ä»¥ä¸‹ç¤ºä¾‹æ•°æ®ï¼š

### ç¤ºä¾‹æ‚£è€…æ•°æ®ï¼š
- å¼ ä¸‰ (ç”·, 28å², 175cm, 70.5kg)
- æå›› (å¥³, 25å², 165cm, 55.0kg)
- ç‹äº” (ç”·, 35å², 180cm, 80.0kg)

### è¿åŠ¨åˆ†ç±»ï¼š
- åŠ›é‡è®­ç»ƒ
- å§¿æ€çº æ­£
- åº·å¤è®­ç»ƒ

### è¿åŠ¨é¡¹ç›®ï¼š
- æ ‡å‡†æ·±è¹² (squat)
- äºŒå¤´å¼¯ä¸¾ (bicep-curl)
- å§¿æ€è¯„ä¼° (posture-assessment)

## ğŸš¨ å¸¸è§é—®é¢˜è§£å†³

### 1. è¿æ¥è¢«æ‹’ç» (Access denied)
**é”™è¯¯**: `Access denied for user 'root'@'localhost'`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„å¯†ç æ˜¯å¦æ­£ç¡®
2. é‡ç½® MySQL root å¯†ç ï¼š
```bash
# åœæ­¢ MySQL æœåŠ¡
sudo systemctl stop mysql

# å®‰å…¨æ¨¡å¼å¯åŠ¨
sudo mysqld_safe --skip-grant-tables &

# é‡ç½®å¯†ç 
mysql -u root
USE mysql;
UPDATE user SET authentication_string=PASSWORD('æ–°å¯†ç ') WHERE User='root';
FLUSH PRIVILEGES;
EXIT;

# é‡å¯ MySQL æœåŠ¡
sudo systemctl restart mysql
```

### 2. æ•°æ®åº“ä¸å­˜åœ¨
**é”™è¯¯**: `Unknown database 'posture_scan_pro_db'`

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿å·²æ‰§è¡Œå®Œæ•´çš„åˆå§‹åŒ–è„šæœ¬

### 3. æƒé™é—®é¢˜
**é”™è¯¯**: `Can't create database`

**è§£å†³æ–¹æ¡ˆ**:
```sql
-- ç™»å½• MySQL åæ‰§è¡Œ
GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION;
FLUSH PRIVILEGES;
```

### 4. å­—ç¬¦é›†é—®é¢˜
**é”™è¯¯**: ä¸­æ–‡æ•°æ®æ˜¾ç¤ºä¹±ç 

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿æ•°æ®åº“å’Œè¡¨ä½¿ç”¨ utf8mb4 å­—ç¬¦é›†

## ğŸ’¡ ç»´æŠ¤å»ºè®®

### å®šæœŸå¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
mysqldump -u root -p posture_scan_pro_db > backup_$(date +%Y%m%d).sql

# æ¢å¤æ•°æ®åº“
mysql -u root -p posture_scan_pro_db < backup_20251220.sql
```

### æ€§èƒ½ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
CREATE INDEX idx_assessments_patient_created ON assessments(patient_id, created_at);
CREATE INDEX idx_reports_patient_exercise ON exercise_reports(patient_id, exercise_type);
```

### æ•°æ®æ¸…ç†
```sql
-- æ¸…ç†6ä¸ªæœˆå‰çš„è¯„ä¼°æ•°æ®
DELETE FROM assessments WHERE created_at < DATE_SUB(NOW(), INTERVAL 6 MONTH);
```

## ğŸ‰ å®Œæˆï¼

å¦‚æœæ‚¨å·²æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤å®Œæˆæ•°æ®åº“å»ºç«‹ï¼Œæ‚¨çš„ PostureScan Pro ç°åœ¨åº”è¯¥å¯ä»¥ï¼š

1. âœ… è¿æ¥åˆ° MySQL æ•°æ®åº“
2. âœ… å­˜å‚¨å’Œæ£€ç´¢æ‚£è€…ä¿¡æ¯
3. âœ… ä¿å­˜å§¿æ€è¯„ä¼°æ•°æ®
4. âœ… è®°å½•è¿åŠ¨è®­ç»ƒç»“æœ
5. âœ… ç”Ÿæˆä¸“ä¸šè¯„ä¼°æŠ¥å‘Š

ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨ PostureScan Pro çš„å®Œæ•´åŠŸèƒ½äº†ï¼

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. MySQL æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ
2. æ•°æ®åº“é…ç½®æ–‡ä»¶ `.env` æ˜¯å¦æ­£ç¡®
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†æ•°æ®åº“è¿æ¥

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸƒâ€â™‚ï¸